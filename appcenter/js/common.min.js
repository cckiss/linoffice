/*!
 * project : common
 * author : LINOFFICE
 * 공통 함수
 */ $(function(){let e=$("body"),t=$(".ncc-search"),n=$(".ncc-search legend"),c=$(".ncc-search-close"),i=$("#nccSuggestInput"),s=$(".ncc-search-input-delete"),a=$(".ncc-ncservice-btn"),l=$(".ncc-left-panel-close"),r=$(".ncc-left-panel"),o=$(".ncc-login--after"),u=$(".ncc-right-panel-close"),d=$(".ncc-right-panel"),p=$(".ncc-profile-charchange"),h=$(".ncc-character-panel-close"),m=$(".ncc-character-panel"),f=$("#notiList > .wrap_btns > .btnSetting"),g=$("#notiSetting > .wrap_btns > .btnApply"),b=$("#notiSetting > .wrap_btns > .btnCancel"),v=($(".menu_item"),$(".ncc-dimmed")),y=$(".ncc-character-list > li"),C=$(".my-character-list .list .items");_show=function(t){t.addClass("is-active"),v.addClass("is-active-left"),e.addClass("ncc-dimmed")},_hide=function(t){t.removeClass("is-active"),v.removeClass("is-active-left"),e.removeClass("ncc-dimmed")},a.on("click",function(e){_show(r),eventStop(e)}),l.on("click",function(e){_hide(r),eventStop(e)}),o.on("click",function(e){_show(d),eventStop(e)}),u.on("click",function(e){_hide(d),eventStop(e)}),p.on("click",function(e){m.addClass("is-active"),eventStop(e)}),h.on("click",function(e){m.removeClass("is-active"),eventStop(e)}),t.click(function(e){e.stopPropagation()}),n.on("click",function(e){e.preventDefault(),showSearchField()}),c.on("click",()=>(hideSearchField(),!1)),s.on("click",function(e){return resetSearchField(),i.click().focus(),!1}),e.on("click",function(n){let c=$(n.target);var i=c.hasClass("ncc-left-panel"),s=c.hasClass("ncc-right-panel"),a=c.hasClass("ncc-character-panel"),l=c.hasClass("ncc-dimmed");i||s||a||!l||(r.removeClass("is-active"),d.removeClass("is-active"),m.removeClass("is-active"),v.removeClass("is-active-left"),e.removeClass("ncc-dimmed")),t.has(n.target).length||hideSearchField()}),y.on("click",function(e){if($(this).find("span").html()==$(".ncc-login--info__char").html()){m.removeClass("is-active"),eventStop(e);return}let t=$(this).find("#select_charter_choice").val(),n=window.location.href;t&&charChangeForm(t,n,"post","/account/chageCharacter")}),C.on("click",function(e){if($(this).find(".name").html()==$(".ncc-login--info__char").html()){$(".ui-signature .btn").removeClass("open"),$(".my-character-list").hide();return}let t=$(this).find("#select_charter_choice").val(),n=window.location.href;t&&charChangeForm(t,n,"post","/account/chageCharacter")}),f.on("click",function(e){$("#notiList").css("display","none"),$("#notiSetting").css("display","")}),g.on("click",function(e){noti_apply(),$("#notiSetting").css("display","none"),$("#notiList").css("display","")}),b.on("click",function(e){$("#notiSetting input[type=checkbox]").prop("checked",account.alimReceive),$("#notiSetting").css("display","none"),$("#notiList").css("display","")});var k=$("#nc-cnb .ncc-lnb-hover").width()>>1,A=0,S=0,w="undefined"==typeof pageCnbType?void 0:pageCnbType,_="undefined"==typeof pageCnbSubType?void 0:pageCnbSubType;if(w){$(".ncc-lnb").removeClass("ncc-lnb-type--main"),$(".ncc-lnb-item.m"+w).addClass("is-active"),$(".ncc-lnb .m"+w+" .ncc-lnb-item__sub > .s"+_).addClass("is-active");let T=$(".ncc-lnb .m"+w+" .ncc-lnb-item__sub > .s"+_);A=T&&T.offset()?parseInt(T.offset().left+(T.width()>>1)-k,10):0,S=T&&T.offset()?T.length?(94*T.width()/100*.01*1.4).toFixed(2):.1:0,$(".ncc-lnb-hover").css({transform:"translateX("+A+"px) scaleX("+S+")",opacity:"1"}),"ingame"===device||"launcher"===device?pageIngameCnbChange(w,_):pageCnbChange(w,_)}else("ingame"===device||"launcher"===device)&&pageIngameCnbChange(w,_);var I=$(".ncc-lnb-type--main");$(".ncc-lnb-item").hover(function(){$(".ncc-lnb-item").removeClass("is-active"),$(this).addClass("is-over"),I.addClass("ncc-lnb-type--main-over")},function(){$(this).removeClass("is-over"),I.removeClass("ncc-lnb-type--main-over"),w&&$(".ncc-lnb-item.m"+w).addClass("is-active")}),$(".ncc-lnb-item__sub > li").hover(function(){$(".ncc-lnb-item__sub > li").removeClass("is-active"),$(this).addClass("is-active");let e=parseInt($(this).offset().left+($(this).width()>>1)-k,10),t=$(this).length?(94*$(this).width()/100*.01*1.4).toFixed(2):.1;$(".ncc-lnb-hover").css({transform:"translateX("+e+"px) scaleX("+t+")",opacity:"1"})},function(){$(this).removeClass("is-active"),$(".ncc-lnb-hover").css({opacity:"0"}),w&&($(".ncc-lnb .m"+w+" .ncc-lnb-item__sub > .s"+_).addClass("is-active"),$(".ncc-lnb-hover").css({transform:"translateX("+A+"px) scaleX("+S+")",opacity:"1"}))}),$(window).scroll(function(){$(this).scrollTop()>100?$(".is-top").addClass("is-sticky"):$(".is-top").removeClass("is-sticky")}),$(document).ready(function(){$(".scrollbar-macosx").scrollbar()})});var pre_suggest,suggestLock=!1,suggestTimeLock=!1;function searchInputKeyup(e,t){if(37!=t.keyCode&&39!=t.keyCode){var n=$(e).closest("#nccSuggestForm"),c=n.find("#nccSuggestWrap"),i=c.find("ul"),s=n.children(".ncc-search-input-delete"),a=$(e).val(),l=a.length;if(38==t.keyCode){nccSuggestDirectionKey(e,!1);return}if(40==t.keyCode){nccSuggestDirectionKey(e,!0);return}pre_suggest!=a&&(pre_suggest=a,l?(s.css("display","inline"),suggestLock||suggestTimeLock||"true"!=suggestEnable||(suggestTimeLock=!0,setTimeout(function(){var t=$(e).val();t.length&&nccSuggestAjax(t),suggestTimeLock=!1},1e3))):(i.children().remove(),c.css("display","none"),s.css("display","none")))}}function nccSuggestAjax(e){!suggestLock&&(suggestLock=!0,$.ajax({type:"post",datatype:"json",url:"/define/suggest",data:{query:e,limit:10,type:"0"},success:function(e){if(e.length){$("#nccSuggestForm #nccSuggestWrap ul").children().remove();var t="";$.each(e,function(e,n){t+='<li data-index="'+e+'" data-keyword="'+n+'" onClick="javascript:suggestClick(this);">'+n+"</li>"}),$("#nccSuggestForm #nccSuggestWrap ul").html(t),$("#nccSuggestForm #nccSuggestWrap").css("display","")}suggestLock=!1},error:function(e,t,n){suggestLock=!1}}))}function nccSuggestDirectionKey(e,t){var n=$(e).closest("#nccSuggestForm"),c=n.find("#nccSuggestWrap > #nccSuggestList > div > ul > li");if(c.length){var i=n.find("#nccSuggestWrap > #nccSuggestList > div > ul > .focus");if(i.length){var s=Number(i.attr("data-index"));n.find("#nccSuggestWrap ul li").removeClass("focus"),n.find("#nccSuggestWrap ul li[data-index="+(t?s+1:s-1)+"]").addClass("focus")}else n.find("#nccSuggestWrap ul li[data-index="+(t?0:c.length-1)+"]").addClass("focus");$(e).val($("#nccSuggestWrap > #nccSuggestList > div > ul > .focus").attr("data-keyword"))}}function pageCnbChange(e,t){let n=$(".wrap-header .header .header-title").html(),c=$(".ncc-lnb-wrap .ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+e),i=c.children("a").attr("href"),s=c.children(".ncc-lnb-item__sub").children("li"),a="";$.each(s,function(e,t){a+='<span class="ncc-depth2-list-items s'+(e+1)+'"><a href="'+$(t).children("a").attr("href")+'">'+$(t).find("span").html()+"</a></span>"});let l='<nav class="ncc-lnb-title" style="z-index:1;"><p class="ncc-lnb-title--current"><a href="'+i+'">'+n+'</a></p><div class="ncc-depth2-list-wrap" id="ncc-depth2-tap"><div class="ncc-depth2-scroller" style="display:inline-block;"><div class="ncc-depth2-list">'+a+"</div></div></div></nav>";$(".ncc-gnb-wrap").append(l),$(".ncc-lnb-title .ncc-depth2-list .ncc-depth2-list-items.s"+t).addClass("selected"),$(".ncc-gnb-wrap .ncc-bi").css("display","none")}function pageIngameCnbChange(e,t){let n=$(".ncc-lnb-wrap .ncc-lnb .ncc-lnb-list .ncc-lnb-item.m"+e),c=$(".ncc-lnb-wrap .ncc-lnb .ncc-lnb-list .ncc-lnb-item > a"),i=n.children(".ncc-lnb-item__sub").children("li"),s="";$.each(c,function(e,t){s+='<a href="'+$(t).attr("href")+'">'+$(t).find("span").html()+"</a>"});let a="";$.each(i,function(e,t){a+='<span class="ncc-depth2-list-items s'+(e+1)+'"><a href="'+$(t).children("a").attr("href")+'">'+$(t).find("span").html()+"</a></span>"});let l='<nav class="ncc-lnb-title" style="z-index:1;"><p class="ncc-lnb-title--current"><a href="/index">홈</a>'+s+"</p>"+(a.length?'<div class="ncc-depth2-list-wrap" id="ncc-depth2-tap"><div class="ncc-depth2-scroller" style="display:inline-block;"><div class="ncc-depth2-list">'+a+"</div></div></div>":"")+"</nav>";if($(".ncc-gnb-wrap").append(l),void 0!==e){let r=Number(e)-(Number(e)>4?1:0);$(".ncc-lnb-title .ncc-lnb-title--current > a").eq(r).addClass("selected"),$(".ncc-lnb-title .ncc-depth2-list .ncc-depth2-list-items.s"+t).addClass("selected")}$(".ncc-gnb-wrap .ncc-bi").css("display","none")}function createSessionConfig(e,t){switch(e){case"/notice/view":case"/update/view":case"/event/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"notice",type:t,list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/board/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"free",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/contents/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"content",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/pitch/view":setSession("COMMUNITY_INFINITE_LIST",JSON.stringify(communityInfiniteList={board:"pitch",list_count:$("#cursize").val(),scroll_Y:window.scrollY}));break;case"/goods/view":if("undefined"==typeof current_page_number)return;setSession("PAGINATION_INFINITE_LIST",JSON.stringify(paginationInfiniteList={page_type:"goods",page_number:current_page_number,scroll_Y:window.scrollY}))}}function urlform(e,t,n){createSessionConfig(n);var c=document.createElement("form");if(c.setAttribute("charset","UTF-8"),c.setAttribute("method",t),c.setAttribute("action",n),void 0!=e&&"null"!=e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","num"),i.setAttribute("value",e),c.appendChild(i)}document.body.appendChild(c),c.submit()}function urlTypeform(e,t,n,c){createSessionConfig(c,e);var i=document.createElement("form");if(i.setAttribute("charset","UTF-8"),i.setAttribute("method",n),i.setAttribute("action",c),e&&"null"!=e){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","type"),s.setAttribute("value",e),i.appendChild(s)}if(t&&"null"!=t){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","num"),s.setAttribute("value",t),i.appendChild(s)}document.body.appendChild(i),i.submit()}function urlQueryform(e,t,n){var c=document.createElement("form");if(c.setAttribute("charset","UTF-8"),c.setAttribute("method",t),c.setAttribute("action",n),e&&"null"!=e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","query"),i.setAttribute("value",e),c.appendChild(i)}document.body.appendChild(c),c.submit()}function charChangeForm(e,t,n,c){var i=document.createElement("form");if(i.setAttribute("charset","UTF-8"),i.setAttribute("method",n),i.setAttribute("action",c),t&&"null"!=t){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","urlType"),s.setAttribute("value",t),i.appendChild(s)}if(e&&"null"!=e){var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","num"),s.setAttribute("value",e),i.appendChild(s)}document.body.appendChild(i),i.submit()}function login(){var e=document.createElement("form");e.setAttribute("charset","UTF-8"),e.setAttribute("method","post"),"ingame"===device?e.setAttribute("action","/login_ingame"):e.setAttribute("action","/login");var t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","urlType"),t.setAttribute("value",window.location.href),e.appendChild(t),document.body.appendChild(e),e.submit()}function loginIngame(){var e=document.createElement("form");e.setAttribute("charset","UTF-8"),e.setAttribute("method","post"),e.setAttribute("action","/login_ingame");var t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","urlType"),t.setAttribute("value",window.location.href),e.appendChild(t),document.body.appendChild(e),e.submit()}function logout(){"launcher"===device?$.ajax({type:"GET",datatype:"json",url:"/define/logout",success:function(e){},error:function(e,t,n){throw Error("logout from common.js Error")}}):location.href="/account/logout"}function totalSearchCheck(){return!!nccSuggestForm.query.value&&(nccSuggestForm.action="/search",!0)}function suggestClick(e){nccSuggestForm.query.value=$(e).attr("data-keyword"),nccSuggestForm.action="/search",nccSuggestForm.submit()}function showSearchField(){$(".ncc-search").hasClass("is-active")||($(".ncc-search").addClass("is-active"),$(".ncc-search legend").css("display","none"),$(".ncc-lnb").addClass("search-active"),window.setTimeout(()=>{$(".ncc-search-input").click().focus()},300))}function hideSearchField(){$(".ncc-search").hasClass("is-active")&&($(".ncc-search").removeClass("is-active"),$(".ncc-search legend").fadeIn(),$(".ncc-lnb").removeClass("search-active"),this.resetSearchField())}function resetSearchField(){$("#nccSuggestWrap").css("display","none"),$("#nccSuggestWrap ul").children().remove(),$(".ncc-search-input").val(""),$(".ncc-search-input-delete").hide()}let alime_deleted=!1;function alimDelete(e){!alime_deleted&&(alime_deleted=!0,$.ajax({type:"post",datatype:"json",url:"/define/alim/delete",data:{id:e},success:function(t){$("#notiList #alim_"+e).remove(),t.length?$(".ncc-noti-tab span").html(t.length):($(".ncc-noti-tab span").css("display","none"),$("#notiList ul").append('<li class="on"><div class="wrapNotice"><a href="javascript:;"><p class="noticeMsg">알림이 없습니다.</p><div class="thumb"><img class="icon" src="/img/27009.png" alt="nickname"></div></a></div></li>')),alime_deleted=!1},error:function(e,t,n){throw alime_deleted=!1,Error("alimDelete from common.js Error")}}))}function noti_apply(){let e=$("#notiSetting input[type=checkbox]").prop("checked");e!=account.alimReceive&&$.ajax({type:"post",datatype:"json",url:"/define/alim/setting",data:{is_receive:e},success:function(t){t&&(account.alimReceive=e)},error:function(e,t,n){throw Error("noti_apply from common.js Error")}})}const windowObjects=[];function ingameCustomBrowser(){"ingame"===device&&"customBrowser"!==window.name&&(openPopup(window.location.href,800,650,"customBrowser",1,0,!1,!0),$("body").html('<div id="customForm"><h1 style="text-align: center;">새롭게 생성된 임시 브라우저에서 이용하십시오.</h1></div>'))}function openPopup(e,t,n,c,i,s,a,l,r){try{if(1!==i&&0!==i&&"1"!==i&&"0"!==i){var o=i;i=c,c=o}if(navigator.platform.toUpperCase().indexOf("MAC")>=0)var u=n+22;else var u=n;if("string"==typeof e){var d="width="+t+",height="+n+", innerHeight="+u+",toolbar=no,location=no,status=no,menubar=no,top=20,left=20,scrollbars="+i+",resizable=no";""!=c&&c||(c="popup"),a&&(d="fullscreen=1,scrollbars=0");var p=window.open(e,c,d);return null!=p&&p.focus(),l&&windowObjects.push(p),p}c||(c="popup"),i||(i="auto");var h=r?e.href+"?"+r:e.href,d="width="+t+",height="+n+", innerHeight="+u+",toolbar=no,location=no,status=no,menubar=no,top=20,left=20,scrollbars="+i+",resizable=no";a&&(d="fullscreen=1,scrollbars=0");var p=window.open(h,c,d);return s&&(null==p?alert("팝업 차단을 해제하여 주시기 바랍니다."):p.focus()),l&&windowObjects.push(p),p}catch(m){}}function get_account_from_launcher(){let e={NCOIN:account?commaAdd(account.ncoin):0,NPOINT:account?commaAdd(account.npoint):0};return e}function get_gamestart_auth_from_launcher(e){if("launcher"!==device)return{AUTH_CODE:2};if(!account)return{AUTH_CODE:3};if(!e)return{AUTH_CODE:5};let t=0;return $.ajax({url:"/define/gamestart",type:"GET",dataType:"json",data:{token:e},async:!1,success(e){t=e}}),{AUTH_CODE:t}}window.onunload=function(){if(windowObjects.length)for(var e of windowObjects)e.close()};
