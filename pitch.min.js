/*!
 * project : pitch
 * author : LINOFFICE
 * 홍보 게시판
 */ function commentLengthCheck(e){$(e).val().length>300&&$(e).val($(e).val().substr(0,300)),$(".count-word > em").text($(e).val().length)}function reportBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(e),"홍보_ID_"+$(e).attr("data-boardid"))}function commentReportBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(e),"홍보_ID_"+$(e).attr("data-boardid")+"_코멘트_ID_"+$(e).attr("data-commentid"))}function reportModalOpen(e,a){$("#ncCommunityReport .report-target .target").html(e.attr("data-name")),$("#reportLog").val(a),$("#ncCommunityReportModal").addClass("is-active"),$("#ncCommunityReport").addClass("is-active")}function reportModalClose(){$("#ncCommunityReportModal").removeClass("is-active"),$("#ncCommunityReport").removeClass("is-active")}function reportInsert(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let a=$("input:radio[name=reportCase]:checked").val(),t=$("#reportLog").val(),s=$("#ncCommunityReport .report-target .target").html();$.ajax({type:"post",datatype:"json",url:"/define/report/insert",data:{targetName:s,type:a,log:t},success:function(e){popupShow(e,'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),reportModalClose()},error:function(e,a,t){throw Error("reportInsert from ptich.js Error")}})}function likeBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(e),"/define/board/like",{board_type:"pitch",id:$(e).attr("data-id")})}function commentLikeBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(e),"/define/board/commentLike",{board_type:"pitch",id:$(e).attr("data-commentid"),boardnum:$(e).attr("data-boardnum")})}function boardLikeBtn(e,a,t){$.ajax({type:"post",datatype:"json",url:a,data:t,success:function(a){e.find("em").html(Number(e.find("em").html())+a),1===a?e.addClass("is-active"):-1===a&&e.removeClass("is-active")},error:function(e,a,t){throw Error("boardLikeBtn from ptich.js Error")}})}function boardCommentWrite(){let e=$(".comment-form-textarea > textarea");if(!e.val().length){popupShow("댓글을 작성해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let a=$("#ncCommunityView").attr("data-board-id"),t=$("#ncCommunityView").attr("data-board-num"),s={board_type:"pitch",content:e.val(),boardId:a};$.ajax({type:"post",datatype:"json",url:"/define/board/commentInsert",data:s,success:function(a){if(a){$('<div class="comment-article" data-commentid="'+a.id+'"><div class="comment-info"><span class="thumb"><img src="'+a.profileUrl+'" alt=""></span><span class="writer">'+a.name+'<span class="server">'+serverName+'</span></span><span class="date">'+moment(new Date(a.date)).format("YYYY. MM. DD. HH:mm:ss")+'</span><button class="co-btn btn-declare" data-commentid="'+a.id+'" data-boardnum="'+t+'" data-name="'+a.name+'" aria-label="신고" onClick="commentReportBtn(this);">&nbsp;신고</button><button class="co-btn btn-delete" aria-label="삭제" onClick="deleteComment(this, '+a.id+');">&nbsp;삭제</button></div><div class="comment-contents">'+a.content+'</div><div class="comment-utils"><button data-commentid="'+a.id+'" data-boardnum="'+t+'" class="co-btn co-btn-like" aria-label="좋아요수" onClick="commentLikeBtn(this);"><svg class="fe-svg fe-svg-like_s" style="width: 16px; height: 16px; vertical-align: middle; fill: rgba(0,0,0,.45)!important; color: rgba(0,0,0,.45)!important;"><use xlink:href="#fe-svg-like_s"></use></svg>&nbsp;<em class="text">'+(a.likenames?a.likenames.length:0)+"</em></button></div></div>").appendTo(".commentThread"),$(".comment-article-none").remove(),e.val("");var s=$(".commentTotalCount");s.html(Number(s.html())+1)}else popupShow("고객님께서는 계정 또는 대표캐릭터 미설정 상태거나 이용제한 상태입니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},error:function(e,a,t){throw Error("boardCommentWrite from ptich.js Error")}})}function deleteComment(e,a){popupShow("댓글을 삭제하시겠습니까?",'<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>','<span class="type1"><a href="javascript:deleteCommentAction('+a+');" class="close">예</a></span>')}function deleteCommentAction(e){$.ajax({type:"post",datatype:"json",url:"/define/board/commentDelete",data:{board_type:"pitch",id:e},success:function(a){if(a){var t=$(".comment-article");$(t).each(function(a,s){t.eq(a).attr("data-commentid")==e&&s.remove()}),popupClose();var s=$(".commentTotalCount");s.html(Number(s.html())-1),0>=Number(s.html())&&$(".commentThread").html('<div class="comment-article-none"><p>첫 댓글을 남겨주세요.</p></div>')}else popupShow("댓글 삭제에 실패하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},error:function(e,a,t){throw Error("deleteCommentAction from ptich.js Error")}})}$(function(){includeHTML(document.querySelector("#svg-container"),"/svg.html");var e=$(".ui-dropdown"),a=$(".ui-dropdown-custom_items"),t=$(".co-btn-reset"),s=$(".btn-list"),n=$(".btn-cards"),o=$(".ncCommunityBoardList"),i=$(".co-btn-top_list"),r=$(".btn-type-selected");e.on("click",function(e){$(this).toggleClass("is-active")}),a.on("click",function(e){$(".ui-dropdown-community.is-active .select").find("span").html($(this).attr("data-textvalue")),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),t.on("click",function(e){$("#ncCommunitySearch").val("")});var l=function(e){if($(".co-btn").removeClass("is-disabled"),"card"==e){s.addClass("is-disabled"),o.hasClass("board-list-default")&&o.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),r.removeClass("list"),r.addClass("card");var a="<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>";r.html(a)}else{n.addClass("is-disabled"),o.hasClass("board-list-card")&&o.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),r.removeClass("card"),r.addClass("list");var a="<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>";r.html(a)}r.removeClass("is-show")};s.on("click",function(e){o.hasClass("board-list-card")&&(l("list"),setLocal("board_fitch_viewMode","list"))}),n.on("click",function(e){o.hasClass("board-list-default")&&(l("card"),setLocal("board_fitch_viewMode","card"))}),"card"==getLocal("board_fitch_viewMode")&&l("card"),i.on("click",function(e){$(window).scrollTop(0),e.preventDefault()}),r.on("click",function(e){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(e){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(e){$("#wrapSearch").removeClass("is-show")}),$(".contentWrite").on("click",function(e){$(this).closest(".comment-form-contentWrite").hasClass("is-active")||(eventStop(e),location.href="/login")}),$(".comment-toolbar > .right > button").on("click",function(e){boardCommentWrite()}),$("#ncCommunityReport .ly-close").on("click",function(e){reportModalClose()}),$("#ncCommunityReport .co-btn-finish").on("click",function(e){reportInsert($(this))}),$("body").mouseup(function(e){!$(".option").has(e.target).length&&!$(".ui-dropdown.is-active").has(e.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(e.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(e)}),$(document).ready(function(){var e=$(".nowCheckvalue");e&&e.length&&$.each(e,function(e,a){if(!a.value){var t=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(t)}})})});let more_btn_lock=!1;function boardMore(){if(!more_btn_lock){$(".nc-community-loader").css("display","");var e=$("#totSize").val(),a=$("#cursize").val();more_btn_lock=!0,$.ajax({type:"post",datatype:"json",url:"/define/board/more",data:{board_type:"pitch",size:a},success:function(t){let s="";$.each(t,function(e,a){s+=createBoardHtml(a)}),$(s).appendTo(".ncCommunityBoardList"),t.length>0&&($("#cursize").val(Number(a)+Number(t.length)),$("#totSize").val(Number(e)-Number(t.length)),$("#totSize").val()?$(".wrap-community-more").html('<button class="nc-comment-more" onClick="javascritp:boardMore();"><span class="txt">더보기</span></button>'):$(".wrap-community-more").html("")),$(".nc-community-loader").css("display","none"),more_btn_lock=!1},error:function(e,a,t){throw $(".nc-community-loader").css("display","none"),more_btn_lock=!1,Error("boardMore from ptich.js Error")}})}}function createBoardHtml(e){var a=$(".ncCommunityBoardList"),t="",s="display:none;";a.hasClass("board-list-card")&&(t="display:none;",s="");let n=moment().format("YYYYMMDD"),o=moment(new Date(e.date)).format("YYYYMMDD"),i=n-o;return'<li class="board-items" onClick=\'urlform("'+e.rownum+'", "post", "/pitch/view");\'><div class="title board-type-list" style="'+t+'"><span class="category">홍보&nbsp;</span><a href=\'javascript:urlform("'+e.rownum+'", "post", "/pitch/view");\'>'+e.title+"</a>"+(e.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':"")+'<div class="count"><span class="count-like" data-count="'+(e.likenames?e.likenames.length:0)+'">&nbsp;<svg class="fe-svg fe-svg-like_s"><use xlink:href="#fe-svg-like_s"></use></svg><em>'+(e.likenames?e.likenames.length:0)+'</em></span><span class="count-comment" data-count="'+(void 0!=e.answerList?e.answerList.length:0)+'">&nbsp;<svg class="fe-svg fe-svg-comment"><use xlink:href="#fe-svg-comment"></use></svg><em>'+(e.answerList?e.answerList.length:0)+"</em></span></div>"+(0===i?'&nbsp<i class="fe-icon-new" data-diff=""></i>':"")+'</div><div class="info board-type-list" style="'+t+'"><span class="writer">'+(void 0!=e.type?'<img src="/img/lineage_writer.png" alt="">':e.name+'<span class="server">'+serverName+"</span>")+'</span>&nbsp<span class="date">'+moment(new Date(e.date)).format("YY.MM.DD.")+'</span>&nbsp<span class="hit"><em class="txt">조회</em>'+e.readcount+'</span><span class="like">추천<em>'+(e.likenames?e.likenames.length:0)+'</em></span></div><div class="comment"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/pitch/view");\'><span><em class="number">'+(e.answerList?e.answerList.length:0)+'</em><em class="txt">댓글</em></span></a></div><div class="board-type-card" style="'+s+'">'+(e.mainImg?'<div class="board-items-thumb"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/pitch/view");\'><img src="'+e.mainImg+'" alt=""></a></div>':"")+'<div class="board-items-contents"><div class="title"><span class="category">홍보&nbsp;</span><a href=\'javascript:urlform("'+e.rownum+'", "post", "/pitch/view");\'>'+e.title+(0===i?'&nbsp<i class="fe-icon-new"></i></a>':"")+'</div><div class="desc desc-overflow"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/pitch/view");\'>'+e.content+'</a></div><span class="writer">'+(void 0!=e.type?'<img src="/img/lineage_writer.png" alt="">':e.name+'<span class="server">'+serverName+"</span>")+'</span>&nbsp</div><div class="board-items-footer"><div class="info"><span class="writer">'+e.name+'</span><span class="date">'+moment(new Date(e.date)).format("YY. MM. DD.")+'</span>&nbsp<span class="hit-count"><span class="txt">조회 </span><em>'+e.readcount+'</em></span></div><div class="count"><span class="count-like" data-count="'+(e.likenames?e.likenames.length:0)+'"><svg class="fe-svg fe-svg-like_s"><use xlink:href="#fe-svg-like_s"></use></svg><em>'+(e.likenames?e.likenames.length:0)+'</em></span><span class="count-comment" data-count="'+(e.answerList?e.answerList.length:0)+'"><svg class="fe-svg fe-svg-comment"><use xlink:href="#fe-svg-comment"></use></svg><em>'+(e.answerList?e.answerList.length:0)+"</em></span></div></div></div></li>"}function boardWriteFormCheck(){var e=document.boardWriteForm;return e.title.value?e.content.value?!!maxByteCheck(e.content.value,1):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function noticeWriteFormCheck(){var e=document.boardWriteForm;return e.noti_type.value?e.title.value?e.content.value?!!maxByteCheck(e.content.value,1):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("유형을 선택해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function delectConfirm(e){popupShow("정말로 삭제하시겠습니까?",'<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>','<span class="type1"><a href="javascript:deleteConfirmAction('+e+');" class="close">예</a></span>')}function deleteConfirmAction(e){let a=$(".board-view .view-body").find("img");urlform(e,"post","/pitch/delete"+getDeleteImgSrc(a))}function getDeleteImgSrc(e){let a="";if(e&&e.length){a+="?deleteImgList=";for(var t=0;t<e.length;t++)t>0&&(a+=","),a+=e.eq(t).attr("src")}return a}function pitchCancel(e){let a=$("#tempList").val(),t=$("#oriContent").val(),s=$("#oriList").val();if(!a&&!s){history.back();return}$.ajax({data:{tempList:a,oriContent:t,oriList:s},type:"POST",url:"update"==e?"/define/editor/updatecancel":"/define/editor/insertcancel",cache:!1,success:function(e){history.back()}})}