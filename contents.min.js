/*!
 * project : contents
 * author : LINOFFICE
 * 컨텐츠공모
 */ function commentLengthCheck(e){$(e).val().length>300&&$(e).val($(e).val().substr(0,300)),$(".count-word > em").text($(e).val().length)}function reportBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(e),"컨텐츠공모_ID_"+$(e).attr("data-boardid"))}function commentReportBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}reportModalOpen($(e),"컨텐츠공모_ID_"+$(e).attr("data-boardid")+"_코멘트_ID_"+$(e).attr("data-commentid"))}function reportModalOpen(e,t){$("#ncCommunityReport .report-target .target").html(e.attr("data-name")),$("#reportLog").val(t),$("#ncCommunityReportModal").addClass("is-active"),$("#ncCommunityReport").addClass("is-active")}function reportModalClose(){$("#ncCommunityReportModal").removeClass("is-active"),$("#ncCommunityReport").removeClass("is-active")}function reportInsert(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let t=$("input:radio[name=reportCase]:checked").val(),s=$("#reportLog").val(),a=$("#ncCommunityReport .report-target .target").html();$.ajax({type:"post",datatype:"json",url:"/define/report/insert",data:{targetName:a,type:t,log:s},success:function(e){popupShow(e,'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),reportModalClose()},error:function(e,t,s){throw Error("reportInsert from contents.js Error")}})}function likeBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(e),"/define/board/like",{board_type:"contents",id:$(e).attr("data-id")})}function commentLikeBtn(e){if(!account){popupShow("로그인 후 이용하실 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}boardLikeBtn($(e),"/define/board/commentLike",{board_type:"contents",id:$(e).attr("data-commentid"),boardnum:$(e).attr("data-boardnum")})}function boardLikeBtn(e,t,s){$.ajax({type:"post",datatype:"json",url:t,data:s,success:function(t){e.find("em").html(Number(e.find("em").html())+t),1===t?e.addClass("is-active"):-1===t&&e.removeClass("is-active")},error:function(e,t,s){throw Error("boardLikeBtn from contents.js Error")}})}function boardCommentWrite(){let e=$(".comment-form-textarea > textarea");if(!e.val().length){popupShow("댓글을 작성해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);return}let t=$("#ncCommunityView").attr("data-board-id"),s=$("#ncCommunityView").attr("data-board-num"),a={board_type:"contents",content:e.val(),boardId:t};$.ajax({type:"post",datatype:"json",url:"/define/board/commentInsert",data:a,success:function(t){if(t){$('<div class="comment-article" data-commentid="'+t.id+'"><div class="comment-info"><span class="thumb"><img src="'+t.profileUrl+'" alt=""></span><span class="writer">'+t.name+'<span class="server">'+serverName+'</span></span><span class="date">'+moment(new Date(t.date)).format("YYYY. MM. DD. HH:mm:ss")+'</span><button class="co-btn btn-declare" data-commentid="'+t.id+'" data-boardnum="'+s+'" data-name="'+t.name+'" aria-label="신고" onClick="commentReportBtn(this);">&nbsp;신고</button><button class="co-btn btn-delete" aria-label="삭제" onClick="deleteComment(this, '+t.id+');">&nbsp;삭제</button></div><div class="comment-contents">'+t.content+'</div><div class="comment-utils"><button data-commentid="'+t.id+'" data-boardnum="'+s+'" class="co-btn co-btn-like" aria-label="좋아요수" onClick="commentLikeBtn(this);"><svg class="fe-svg fe-svg-like_s" style="width: 16px; height: 16px; vertical-align: middle; fill: rgba(0,0,0,.45)!important; color: rgba(0,0,0,.45)!important;"><use xlink:href="#fe-svg-like_s"></use></svg>&nbsp;<em class="text">'+(t.likenames?t.likenames.length:0)+"</em></button></div></div>").appendTo(".commentThread"),$(".comment-article-none").remove(),e.val("");var a=$(".commentTotalCount");a.html(Number(a.html())+1)}else popupShow("고객님께서는 계정 또는 대표캐릭터 미설정 상태거나 이용제한 상태입니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},error:function(e,t,s){throw Error("boardCommentWrite from contents.js Error")}})}function deleteComment(e,t){popupShow("댓글을 삭제하시겠습니까?",'<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>','<span class="type1"><a href="javascript:deleteCommentAction('+t+');" class="close">예</a></span>')}function deleteCommentAction(e){$.ajax({type:"post",datatype:"json",url:"/define/board/commentDelete",data:{board_type:"contents",id:e},success:function(t){if(t){var s=$(".comment-article");$(s).each(function(t,a){s.eq(t).attr("data-commentid")==e&&a.remove()}),popupClose();var a=$(".commentTotalCount");a.html(Number(a.html())-1),0>=Number(a.html())&&$(".commentThread").html('<div class="comment-article-none"><p>첫 댓글을 남겨주세요.</p></div>')}else popupShow("댓글 삭제에 실패하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)},error:function(e,t,s){throw Error("deleteCommentAction from contents.js Error")}})}$(function(){includeHTML(document.querySelector("#svg-container"),"/svg.html");var e=$(".ui-dropdown"),t=$(".ui-dropdown-custom_items"),s=$(".co-btn-reset"),a=$(".btn-list"),n=$(".btn-cards"),o=$(".ncCommunityBoardList"),r=$(".co-btn-top_list"),l=$(".btn-type-selected");e.on("click",function(e){$(this).toggleClass("is-active")}),t.on("click",function(e){$(".ui-dropdown-community.is-active .select").find("span").html($(this).attr("data-textvalue")),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),s.on("click",function(e){$("#ncCommunitySearch").val("")});var c=function(e){if($(".co-btn").removeClass("is-disabled"),"card"==e){a.addClass("is-disabled"),o.hasClass("board-list-default")&&o.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),l.removeClass("list"),l.addClass("card");var t="<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>";l.html(t),l.removeClass("is-show")}else{n.addClass("is-disabled"),o.hasClass("board-list-card")&&o.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),l.removeClass("card"),l.addClass("list");var t="<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>";l.html(t),l.removeClass("is-show")}};a.on("click",function(e){o.hasClass("board-list-card")&&(c("list"),setLocal("board_content_viewMode","list"))}),n.on("click",function(e){o.hasClass("board-list-default")&&(c("card"),setLocal("board_content_viewMode","card"))}),"card"==getLocal("board_content_viewMode")&&c("card"),r.on("click",function(e){$(window).scrollTop(0),e.preventDefault()}),l.on("click",function(e){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(e){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(e){$("#wrapSearch").removeClass("is-show")}),$(".contentWrite").on("click",function(e){$(this).closest(".comment-form-contentWrite").hasClass("is-active")||(eventStop(e),location.href="/login")}),$(".comment-toolbar > .right > button").on("click",function(e){boardCommentWrite()}),$("#ncCommunityReport .ly-close").on("click",function(e){reportModalClose()}),$("#ncCommunityReport .co-btn-finish").on("click",function(e){reportInsert($(this))}),$("body").mouseup(function(e){!$(".option").has(e.target).length&&!$(".ui-dropdown.is-active").has(e.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(e.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(e)}),$(document).ready(function(){var e=$(".nowCheckvalue");e&&e.length&&$.each(e,function(e,t){if(!t.value){var s=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(s)}})})});let more_btn_lock=!1;function boardMore(){if(!more_btn_lock){$(".nc-community-loader").css("display","");var e=$("#totSize").val(),t=$("#cursize").val();more_btn_lock=!0,$.ajax({type:"post",datatype:"json",url:"/define/board/more",data:{board_type:"contents",size:t},success:function(s){let a="";$.each(s,function(e,t){a+=createBoardHtml(t)}),$(a).appendTo(".ncCommunityBoardList"),s.length&&($("#cursize").val(Number(t)+Number(s.length)),$("#totSize").val(Number(e)-Number(s.length)),$("#totSize").val()?$(".wrap-community-more").html('<button class="nc-comment-more" onClick="javascritp:boardMore();"><span class="txt">더보기</span></button>'):$(".wrap-community-more").html("")),$(".nc-community-loader").css("display","none"),more_btn_lock=!1},error:function(e,t,s){throw $(".nc-community-loader").css("display","none"),more_btn_lock=!1,Error("boardMore from contents.js Error")}})}}function createBoardHtml(e){var t=$(".ncCommunityBoardList"),s="",a="display:none;";t.hasClass("board-list-card")&&(s="display:none;",a="");let n=moment().format("YYYYMMDD"),o=moment(new Date(e.date)).format("YYYYMMDD"),r=n-o;return'<li class="board-items" onClick=\'urlform("'+e.rownum+'", "post", "/contents/view");\'><div class="title board-type-list" style="'+s+'"><span class="category">컨텐츠&nbsp;</span><a href=\'javascript:urlform("'+e.rownum+'", "post", "/contents/view");\'>'+e.title+"</a>"+(e.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':"")+'<div class="count"><span class="count-like" data-count="'+(e.likenames?e.likenames.length:0)+'">&nbsp;<svg class="fe-svg fe-svg-like_s"><use xlink:href="#fe-svg-like_s"></use></svg><em>'+(e.likenames?e.likenames.length:0)+'</em></span><span class="count-comment" data-count="'+(e.answerList?e.answerList.length:0)+'">&nbsp;<svg class="fe-svg fe-svg-comment"><use xlink:href="#fe-svg-comment"></use></svg><em>'+(e.answerList?e.answerList.length:0)+"</em></span></div>"+(0===r?'&nbsp<i class="fe-icon-new" data-diff=""></i>':"")+'</div><div class="info board-type-list" style="'+s+'"><span class="writer">'+(e.type?'<img src="/img/lineage_writer.png" alt="">':e.name+'<span class="server">'+serverName+"</span>")+'</span>&nbsp<span class="date">'+moment(new Date(e.date)).format("YY.MM.DD.")+'</span>&nbsp<span class="hit"><em class="txt">조회</em>'+e.readcount+'</span><span class="like">추천<em>'+(e.likenames?e.likenames.length:0)+'</em></span></div><div class="comment"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/contents/view");\'><span><em class="number">'+(e.answerList?e.answerList.length:0)+'</em><em class="txt">댓글</em></span></a></div><div class="board-type-card" style="'+a+'">'+(e.mainImg?'<div class="board-items-thumb"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/contents/view");\'><img src="'+e.mainImg+'" alt=""></a></div>':"")+'<div class="board-items-contents"><div class="title"><span class="category">컨텐츠&nbsp;</span><a href=\'javascript:urlform("'+e.rownum+'", "post", "/contents/view");\'>'+e.title+(0===r?'&nbsp<i class="fe-icon-new"></i></a>':"")+'</div><div class="desc desc-overflow"><a href=\'javascript:urlform("'+e.rownum+'", "post", "/contents/view");\'>'+e.content+'</a></div><span class="writer">'+(e.type?'<img src="/img/lineage_writer.png" alt="">':e.name+'<span class="server">'+serverName+"</span>")+'</span>&nbsp</div><div class="board-items-footer"><div class="info"><span class="writer">'+e.name+'</span><span class="date">'+moment(new Date(e.date)).format("YY. MM. DD.")+'</span>&nbsp<span class="hit-count"><span class="txt">조회 </span><em>'+e.readcount+'</em></span></div><div class="count"><span class="count-like" data-count="'+(e.likenames?e.likenames.length:0)+'"><svg class="fe-svg fe-svg-like_s"><use xlink:href="#fe-svg-like_s"></use></svg><em>'+(e.likenames?e.likenames.length:0)+'</em></span><span class="count-comment" data-count="'+(e.answerList?e.answerList.length:0)+'"><svg class="fe-svg fe-svg-comment"><use xlink:href="#fe-svg-comment"></use></svg><em>'+(e.answerList?e.answerList.length:0)+"</em></span></div></div></div></li>"}function boardWriteFormCheck(){var e=document.boardWriteForm;return e.title.value?e.content.value?!!maxByteCheck(e.content.value,1):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function noticeWriteFormCheck(){var e=document.boardWriteForm;return e.noti_type.value?e.title.value?e.content.value?!!maxByteCheck(e.content.value,1):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("유형을 선택해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function delectConfirm(e){popupShow("정말로 삭제하시겠습니까?",'<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>','<span class="type1"><a href="javascript:deleteConfirmAction('+e+');" class="close">예</a></span>')}function deleteConfirmAction(e){let t=$(".board-view .view-body").find("img");urlform(e,"post","/contents/delete"+getDeleteImgSrc(t))}function getDeleteImgSrc(e){let t="";if(e&&e.length){t+="?deleteImgList=";for(var s=0;s<e.length;s++)s>0&&(t+=","),t+=e.eq(s).attr("src")}return t}function contentCancel(e){let t=$("#tempList").val(),s=$("#oriContent").val(),a=$("#oriList").val();if(!t&&!a){history.back();return}$.ajax({data:{tempList:t,oriContent:s,oriList:a},type:"POST",url:"update"==e?"/define/editor/updatecancel":"/define/editor/insertcancel",cache:!1,success:function(e){history.back()}})}