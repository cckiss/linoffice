/*!
 * project : goods
 * author : LINOFFICE
 * N샵
 */ function count_setting(s){let a=$(".cell .box"),e=a.find(".count_num"),p=Number(e.val());if(p<=1&&-1==s){popupShow("최소 구매 수량은 1개 입니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}if(p>=goods_limit_count&&1==s){popupShow(`최대 구매 수량은 ${goods_limit_count}개 입니다.`,'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}let n=p+s,l=goods_price*n;e.val(n),a.find("#itemPrice").text(commaAdd(l)),total_count=n,total_price=l,goods_saved_point&&a.find("#rewardAmount").text(commaAdd(goods_saved_point*n))}function is_buy_validation(){return account?!!account.ingame||(popupShow("인게임에서 구매할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("로그인 후 이용 가능합니다.</br>로그인 하시겠습니까?",'<span class="type2"><a href="javascript:login();" class="close">예</a></span>','<span class="type1"><a href="javascript:popupClose();" class="close">아니오</a></span>'),!1)}function index_page_buy_confirm(s){if(!is_buy_validation())return;let a=get_goods(s);if(!a){popupShow("구매할 상품을 발견하지 못했습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}if("NCOIN"===a.price_type&&account.ncoin<a.price){popupShow("N코인이 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}if("NPOINT"===a.price_type&&account.npoint<a.price){popupShow("N포인트가 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}popupShow("정말로 구매하시겠습니까?",`<span class="type2"><a href="javascript:index_page_buy(${s}, ${a.itemid});" class="close">예</a></span>`,'<span class="type1"><a href="javascript:popupClose();" class="close">아니오</a></span>')}function view_page_buy_confirm(){if(!is_buy_validation())return;let s=$('.goods_option input[name="goods_select"]:checked').val();if(s)for(var a=0;a<goods_list.length;a++)goods_list[a].itemid==s&&(goods=goods_list[a]);if(!goods){popupShow("구매할 상품을 선택해주십시오.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}if("NCOIN"===goods_price_type&&account.ncoin<total_price){popupShow("N코인이 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}if("NPOINT"===goods_price_type&&account.npoint<total_price){popupShow("N포인트가 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">확인</a></span>',null);return}popupShow("정말로 구매하시겠습니까?",'<span class="type2"><a href="javascript:view_page_buy();" class="close">예</a></span>','<span class="type1"><a href="javascript:popupClose();" class="close">아니오</a></span>')}function index_page_buy(s,a){do_goods_buy({id:s,item_id:a,buy_count:1})}function view_page_buy(){do_goods_buy({id:goods.id,item_id:goods.itemid,buy_count:total_count})}$(function(){var s=$("#SearchInput");s.focus(function(){$(this).addClass("on"),$(this).val("")}),$(".gnb .btn_area .btn_reset").on("click",function(a){s.val(""),s.focus()}),$("#searchPanel").find(".btn_search").click(function(){var s=document.searchForm;s.query.value||(s.query.value="ALL"),s.submit()});var a=$(".myshop.btn_menu"),e=$(".menu_area");a.on("click",function(s){$(this).hasClass("on")?($(this).removeClass("on"),e.css("display","none"),$(this).children("span").html("마이N샵")):($(this).addClass("on"),e.css("display","block"),$(this).children("span").html("접기")),eventStop(s)}),$("body").mouseup(function(p){var n=$("#searchPanel");!s.has(p.target).length&&!n.has(p.target).length&&s.hasClass("on")&&s.removeClass("on"),($(p.target).hasClass("input_search")||!$(p.target).hasClass("on")&&!a.has(p.target).length&&!e.has(p.target).length)&&a.hasClass("on")&&(a.removeClass("on"),a.children("span").html("마이N샵"),e.css("display","none")),eventStop(p)});let p=$(".cell .box");p.find(".counterWrap").children(".count_btn.down").on("click",function(s){count_setting(-1)}),p.find(".counterWrap").children(".count_btn.up").on("click",function(s){count_setting(1)})});var buyLock=!1;function do_goods_buy(s){!buyLock&&(buyLock=!0,getDatasWithOption([{type:"POST",url:"/define/goods/buy",dataType:"json",contentType:"application/json",Accept:"application/json",data:s}],s=>{switch(s){case 1:popupShow("구매가 완료되었습니다.</br></br>부가아이템창고에서</br>확인하시기 바랍니다.",'<span class="type2"><a href="javascript:popupCloseReload();" class="close">닫기</a></span>',null);break;case 2:popupShow("인게임에서 구매할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 3:popupShow("계정 정보를 찾을 수 없습니다.",'<span class="type2"><a href="javascript:loginIngame();" class="close">설정</a></span>','<span class="type1"><a href="javascript:popupClose();" class="close">닫기</a></span>');break;case 4:popupShow("대표 캐릭터를 찾을 수 없습니다.",'<span class="type2"><a href="javascript:loginIngame();" class="close">설정</a></span>','<span class="type1"><a href="javascript:popupClose();" class="close">닫기</a></span>');break;case 5:popupShow("월드 내 캐릭터를 찾을 수 없습니다.",'<span class="type2"><a href="javascript:loginIngame();" class="close">설정</a></span>','<span class="type1"><a href="javascript:popupClose();" class="close">닫기</a></span>');break;case 6:popupShow("존재하지 않는 아이템입니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 7:popupShow("Ncoin이 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 8:popupShow("Npoint가 부족합니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 9:popupShow("판매 가능한 시간이 아닙니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 10:popupShow("구매 제한 아이템은 1개씩 구매할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;case 11:popupShow("구매 제한 횟수가 초과되었습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null);break;default:popupShow("구매에 실패하였습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null)}buyLock=!1},s=>{buyLock=!1}))}
