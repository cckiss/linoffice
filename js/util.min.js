/*!
 * project : util
 * author : LINOFFICE
 * 유틸 스크립트
 */ const ua=window.navigator.userAgent;function includeHTML(e,t){let n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&(200==this.status&&(e.innerHTML=this.responseText),404==this.status&&(e.innerHTML="Page not found."))},n.open("GET",t,!0),n.send()}function includeHTML(e,t,n){let s=new XMLHttpRequest;s.onreadystatechange=function(){4==this.readyState&&(200==this.status&&(e.innerHTML=this.responseText),404==this.status&&(e.innerHTML="Page not found."))},s.open("GET",`${t}?${n}`,!0),s.send()}function includeHTML(e,t,n,s){let r=new XMLHttpRequest;r.onreadystatechange=function(){4==this.readyState&&(200==this.status&&(e.innerHTML=this.responseText,s&&s()),404==this.status&&(e.innerHTML="Page not found."))},r.open("GET",`${t}?${n}`,!0),r.send()}function includeJS(e){let t=document.createElement("script");t.src=e,document.body.appendChild(t)}function includeJS(e,t){let n=document.createElement("script");n.src=`${e}?${t}`,document.body.appendChild(n)}function includeJS(e,t,n){let s=document.createElement("script");s.src=`${e}?${t}`,n&&s.addEventListener("load",n),document.body.appendChild(s)}let getDatas=function(e,t,n){let s=[];for(let r=0,u=e.length;r<u;r++){let g=$.ajax({type:"GET",url:e[r],dataType:"json"});s.push(g)}$.when.apply($,s).then(t).fail(n)},getDatasWithOption=function(e,t,n){let s=[];for(let r=0,u=e.length;r<u;r++){let g=$.ajax(e[r]);s.push(g)}$.when.apply($,s).then(t).fail(n)};const locationOriginRegex=/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})/;let isIE=/msie/i.test(ua)||/trident/i.test(ua),isEdge=e=>/Gecko/i.test(e)&&/Edge/i.test(e),isOpera=e=>/Opera/i.test(e)||/OPR\//i.test(e),isChrome=e=>!isEdge(e)&&!isOpera(e)&&/Chrome/i.test(e),isIOS=e=>/iPad|iPhone|iPod/.test(e)&&!window.MSStream,isAndroid=e=>/android/i.test(e),truthy=function e(t){return!!t},falsy=function e(t){return!t},existy=e=>null!=e,isDefined=e=>{let t=!0;return null!=e&&t},isInteger=e=>!!isDefined(e)&&e.constructor===Number&&isFinite(e)&&Math.floor(e)===e,isString=e=>!!isDefined(e)&&e.constructor===String,isNumber=function e(t){return!!isDefined(t)&&t.constructor===Number},isBoolean=e=>!!isDefined(e)&&e.constructor===Boolean,isObject=e=>!!isDefined(e)&&e.constructor===Object,isFunction=e=>!!isDefined(e)&&e.constructor===Function,isRegExp=e=>!!isDefined(e)&&e.constructor===RegExp,not=e=>{if(!isFunction(e))throw TypeError("func parameter type of not() must be Function.");return t=>!e(t)},isNotDefined=not(isDefined),parseInt10=e=>parseInt(e,10),parseStrIntToInt=e=>{let t=e;return isDefined(t)?"number"==typeof t?t:parseInt10(t.split(",").join("")):0},removeElementInArray=function e(t,n){if(!Array.isArray(t))throw TypeError("arr parameter type of removeElementInArray() must be Array.");var s=t.slice(0),r=s.indexOf(n);return r>=0&&s.splice(r,1),s},allOf=function e(){let t=Array.prototype.slice.call(arguments);return t.every(function(e){return!0===e})},anyOf=function e(){let t=Array.prototype.slice.call(arguments);return t.some(function(e){return!0===e})},getDefined=function(e,t){return isDefined(e)?e:t},notSingleEle=not(e=>1===e.length),each=(e,t,n)=>{let s=existy(n)?n:null;if(!(Array.isArray(e)||isString(e)))throw TypeError("dataCanLoop parameter type of each() must be Array or String.");let r=!1;for(let u=0,g=e.length;u<g&&!1!==(r=t.call(s,e[u]));u++);},getFileExtension=e=>{if(!isString(e))throw TypeError("getFileExtension() requires String parameter.");if(e.length<=0)return"";var t,n=e.lastIndexOf(".");return e.substr(n+1)},getFirstObjectHasProperty=function(e,t,n){if(!Array.isArray(e)||e.length<=0||!isString(t))return null;let s,r=null;for(let u=0,g=e.length;u<g;++u)if((s=e[u]).hasOwnProperty(t)){if(isRegExp(n)){if(n.test(s[t])){r=s;break}}else if(s[t]===n){r=s;break}}return r},getObjectHasProperty=function e(t,n){if(!Array.isArray(t)||t.length<=0||!isString(n))return null;let s=null;return each(t,e=>{e.hasOwnProperty(n)&&(s=e[n])}),s},overlappedConditionSortByProperty=function e(t,n,s){let r=Array.prototype.slice.call(t);if(!n||n.constructor!==Array||n.length<0)return r;let u=s>=0?s:0,g=n[u];if(u<=0&&r.sort(g.func),n.length<=1)return r;if(u<n.length-1){let a=g.property,l=u+1,o=n[l],b={},f=[],c=[],h,p;for(let d=0,_=r.length;d<_;d++)b[p=String((h=r[d])[a])]||(b[p]=[],f.push(b[p])),(c=b[p]).push(h);for(let v=0,m=f.length;v<m;v++)(c=f[v]).sort(o.func),f[v]=overlappedConditionSortByProperty(c,n,l);return f.reduce((e,t,n,s)=>e.concat(t))}return r},getPositionFromTranslateStr=e=>{let t={x:0,y:0};if(!isDefined(e))return t;let n=e.match(/[+-]?(\d*\.)?\d+/g);return n.length<=0?t:/translateX/g.test(e)?(t.x=parseFloat(n[0]),t):/translateY/g.test(e)?(t.y=parseFloat(n[0]),t):(t.x=parseFloat(n[0]),n.length>1&&(t.y=parseFloat(n[1])),t)},isIndexInLoop=function e(t,n,s,r){let u=Array.prototype.slice.call(arguments);if(u.length<4)throw Error("isIndexInLoop function requires 4 arguments.");if(!isInteger(t)||!isInteger(n)||!isInteger(s)||!isInteger(r))throw Error("arguments must be Integer Number.");if(t<1||s<1)throw Error("totalLength and startIndex can not smaller than 1.");if(n>t)throw Error("loopGap can not bigger than totalLength.");let g=s;for(let a=0;a<n;a++){if(g===r)return!0;g=g+1>t?1:g+1}return!1},getLoopedLastIndex=function e(t,n,s){let r=Array.prototype.slice.call(arguments);if(r.length<3)throw Error("getLoopedLastIndex function requires 3 arguments.");if(!isInteger(t)||!isInteger(n)||!isInteger(s))throw Error("arguments must be Integer Number.");if(t<1||s<1)throw Error("totalLength and firstIndex can not smaller than 1.");if(n>t||s>t)throw Error("loopGap and firstIndex can not bigger than totalLength.");let u=s;for(let g=0;g<n-1;g++)++u>t&&(u=1);return u},getReverseLoopedFirstIndex=function e(t,n,s){let r=Array.prototype.slice.call(arguments);if(r.length<3)throw Error("getReverseLoopedFirstIndex function requires 3 arguments.");if(!isInteger(t)||!isInteger(n)||!isInteger(s))throw Error("arguments must be Integer Number.");if(t<1||s<1)throw Error("totalLength and lastIndex can not smaller than 1.");if(n>t||s>t)throw Error("loopGap and lastIndex can not bigger than totalLength.");let u=s;for(let g=0;g<n-1;g++)u=u-1<1?t:u-1;return u},getResolution=(e={tablet:640,pc:960,max:1260},t=window)=>{let n="";return e.max&&t.innerWidth>=e.max?"max":e.pc&&t.innerWidth>=e.pc?"pc":e.tablet&&t.innerWidth>=e.tablet?"tablet":"phone"},isPhoneResolution=e=>"phone"===e,isTabletResolution=e=>"tablet"===e,isMobileResolution=e=>"phone"===e||"tablet"===e,numberWithCommas=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),getUriParams=e=>{if(e.length<1)return null;let t=e.split("#")[0].split("?");if(t.length<2)return null;let n=t[1].split("&"),s,r={};for(let u=0,g=n.length;u<g;++u)(s=n[u].split("=")).length>1&&(r[s[0]]=s[1]);return r},getUriCombinedParams=(e,t)=>{if(!e)return"";if(!t)return e;let n="";for(let s in t)n+="&"+s+"="+String(t[s]);if(""===n)return e;var r=e.split("#"),e=r[0],u=isDefined(r[1])?"#"+r[1]:"";return e=(e.indexOf("?")>=0?e+n:e+"?"+n.substr(1))+u},getHashParams=e=>{let t=e;if(t.length<1)return null;let n=t.split("#");if(n.length<2)return null;let s=n[1].split("&"),r,u={};for(let g=0,a=s.length;g<a;++g){if((r=s[g].split("=")).length<=1)return null;u[r[0]]=r[1]}return u},getHashCombinedParams=(e,t)=>{if(!t)return e;let n="";for(let s in t)n+="&"+s+"="+String(t[s]);return""===n?e:e=e.indexOf("#")>=0?e+n:e+"#"+n.substr(1)},getObjForPagination=function(e,t,n,s){let r=Array.prototype.slice.call(arguments);if(r.length<4)throw Error("getObjForPagination() requires 4 parameters.");if(!isInteger(e)||!isInteger(t)||!isInteger(n)||!isInteger(s))throw TypeError("getObjForPagination() requires Integer Number parameters.");if(e<=0||t<=0||n<=0||s<=0)throw TypeError("getObjForPagination() requires positive Integer Number parameters.");let u=Math.ceil(e/t);s<1&&(s=1),s>u&&(s=u);let g=Math.floor((s-1)/n),a=g*n+1,l=a+n-1,o=l+1;return l>u&&(l=u),o>u&&(o=0),{totalPostNum:e,displayPostNumPerPage:t,displayPaginationBtnNum:n,pageIndex:s,totalPageNum:u,prevPageIndex:g*n,firstPageIndex:a,lastPageIndex:l,nextPageIndex:o}},getDivideIntStrByThousandUnit=e=>{if(not(isDefined)(e))return["0"];let t=String(parseStrIntToInt(e)),n=[];if(t.length<=4)return[String(t)];let s=0,r="";for(;t.length>4;)s=t.length,r=t.substr(s-4,s),t=t.substr(0,s-4),n.unshift(r);return n.unshift(t),n},getMarketPriceStr=e=>{let t=["","만","억"],n=isDefined(e)?e:"0",s=getDivideIntStrByThousandUnit(n);s.reverse();let r="",u=0;for(let g=0,a=s.length;g<a;g++)(u=parseInt10(s[g]))<=0||(r=numberWithCommas(u)+t[g]+r,g===s.length||(r=" "+r));return(r=r.trim())?r:"0"},getEmphasizedStrByQuery=(e,t)=>(e||"").split(t).join(`<strong>${t}</strong>`),getSeparatedDateStr=(e,t,n={Sunday:"일",Monday:"월",Tuesday:"화",Wednesday:"수",Thursday:"목",Friday:"금",Saturday:"토"})=>{let s="",r=new Date,u=new Date(t),g=Math.floor((r-u)/1e3);if(g<86400){if(g<3600){if(g<60)s=`${g}초 전`;else{let a=Math.floor(g/60);s=`${a}분 전`}}else{let l=Math.floor(g/3600);s=`${l}시간 전`}}else{let o=e(t);n[o.format("dddd")],s=o.format("YYYY-MM-DD")}return s},namespace=(e,t)=>{if(!isString(e))throw TypeError("namespace parameter type of namespace() must be String.");if(!(isObject(t)||!isDefined(t)))throw TypeError("parent parameter type of namespace() must be Object or null or undefined.");let n=t||window;if(e){let s=e.split(".");for(let r=0,u=s.length;r<u;r++)n[s[r]]||(n[s[r]]={}),n=n[s[r]]}return n},template=function e(t,...n){return function(...e){let s=e[e.length-1]||{},r=[t[0]];return n.forEach(function(n,u){let g=Number.isInteger(n)?e[n]:s[n];r.push(g,t[u+1])}),r.join("")}};function commaAdd(e){return String(e).replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")}function commaRemove(e){return String(e).replace(/[^\d]+/g,"")}function inputNumberFormat(e){e.value=commaAdd(commaRemove(e.value))}function OnCheckPhone(e){e.form;var t=e.value,n="";n=checkDigit(n=RemoveDash2(t)),12!=event.keyCode&&("02"==n.substring(0,2)&&(1>=GetMsgLen(n)&&(e.value=n),2==GetMsgLen(n)&&(e.value=n+"-"),4==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,3)),4==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,4)),5==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,5)+"-"+n.substring(5,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,6)+"-"+n.substring(6,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,5)+"-"+n.substring(5,9)),10==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,6)+"-"+n.substring(6,10)),11==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,6)+"-"+n.substring(6,10)),12==GetMsgLen(n)&&(e.value=n.substring(0,2)+"-"+n.substring(2,6)+"-"+n.substring(6,10))),"05"==n.substring(0,2)&&("0"==n.substring(2,3)?(3>=GetMsgLen(n)&&(e.value=n),4==GetMsgLen(n)&&(e.value=n+"-"),5==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,7)+"-"+n.substring(7,9)),10==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)+"-"+n.substring(8,10)),11==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,7)+"-"+n.substring(7,11)),12==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)+"-"+n.substring(8,12)),13==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)+"-"+n.substring(8,12))):(2>=GetMsgLen(n)&&(e.value=n),3==GetMsgLen(n)&&(e.value=n+"-"),4==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,4)),5==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)+"-"+n.substring(6,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,9)),10==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)+"-"+n.substring(6,10)),11==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11)),12==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11)))),("03"==n.substring(0,2)||"04"==n.substring(0,2)||"06"==n.substring(0,2)||"07"==n.substring(0,2)||"08"==n.substring(0,2))&&(2>=GetMsgLen(n)&&(e.value=n),3==GetMsgLen(n)&&(e.value=n+"-"),4==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,4)),5==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)+"-"+n.substring(6,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,9)),10==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)+"-"+n.substring(6,10)),11==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11)),12==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11))),"01"==n.substring(0,2)&&(2>=GetMsgLen(n)&&(e.value=n),3==GetMsgLen(n)&&(e.value=n+"-"),4==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,4)),5==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,9)),10==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,6)+"-"+n.substring(6,10)),11==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11)),12==GetMsgLen(n)&&(e.value=n.substring(0,3)+"-"+n.substring(3,7)+"-"+n.substring(7,11))),"1"==n.substring(0,1)&&(3>=GetMsgLen(n)&&(e.value=n),4==GetMsgLen(n)&&(e.value=n+"-"),5==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,5)),6==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,6)),7==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,7)),8==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)),9==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)),10==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)),11==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8)),12==GetMsgLen(n)&&(e.value=n.substring(0,4)+"-"+n.substring(4,8))))}function RemoveDash2(e){let t="";for(var n=0;n<e.length;n++)"-"!=e.charAt(n)&&(t+=e.charAt(n));return t}function GetMsgLen(e){let t=0;for(var n=0;n<e.length;n++)e.charCodeAt(n)>127?t+=2:t++;return t}function checkDigit(e){var t=e,n=t.length,s="";for(i=0;i<n;i++)"1234567890".indexOf(t.substring(i,i+1))>=0&&(s+=t.substring(i,i+1));return s}function inputNumberAll(e){let t=checkDigit(e.value);e.value=t}function inputNumber(e){let t=checkDigit(e.value);0==t&&(t=""),e.value=t}function inputCheckNumber(e){let t=checkDigit(commaRemove(e.value));0==(t=commaAdd(Number(t)))&&(t=""),e.value=t}function is_email_check(e){return/^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i.test(e)}function eventStop(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}function maxByteCheck(e,t){return!(Number(byteCheck(e))>1048576*Number(t))||(popupShow(`최대 용량을 초과 하였습니다.(최대 용량 : ${t}MB)`,'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function byteCheck(e){let t=0;for(var n=0;n<e.length;n++){var s=escape(e.charAt(n));1==s.length?t++:-1!=s.indexOf("%u")?t+=2:-1!=s.indexOf("%")&&t++}return t}function getContextPath(){var e=location.href.indexOf(location.host)+location.host.length;return location.href.substring(e,location.href.indexOf("/",e+1))}function getNowDayTimeToFormat(e){var t=new Date,n=new Date(e),s=Math.floor((t-n)/6e4);return 0==s?`방금 전`:s<60?`${s}분 전`:s<1440?`${Math.floor(s/60)}시간 전`:moment(new Date(e)).format("YYYY-MM-DD")}function getCookie(e){for(var t,n,s=document.cookie.split(";"),r=0;r<s.length;r++)if(t=s[r].substr(0,s[r].indexOf("=")),n=s[r].substr(s[r].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))==e)return unescape(n)}function SetCookie(e,t,n,s){var r=`${e}=${encodeURIComponent(t)}`;"number"==typeof n&&(r+=`; max-age=${n}`),"string"==typeof s&&(r+=`; SameSite=${s}`),document.cookie=r}function GetCookie(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}function DelCookie(e){document.cookie=`${e}=; expires=Thu, 01 Jan 1999 00:00:10 GMT;`}
