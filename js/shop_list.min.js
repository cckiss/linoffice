/*!
 * project : shop_list
 * author : LINOFFICE
 * 시세
 */ "SELL"===TRADE_TYPE?($("#tab_sell").addClass("active"),$(".item-price > .price").addClass("price-sell")):"BUY"===TRADE_TYPE&&($("#tab_buy").addClass("active"),$(".item-price > .price").addClass("price-buy")),$(function(){var t={itemId:"-1",enchant:-1,bless:"ALL",attr:"ALL",tradeType:"SELL"},e=function(t){$(".data-loader").css("display","block");$(".pagination-container").pagination({dataSource:function(e){getDatasWithOption([{type:"POST",url:"/define/item-search/view-list",dataType:"json",contentType:"application/json",Accept:"application/json",data:t}],t=>{if(t){$(".search-util__result .count").html(t.length),$(".thumbnail").html(`<img src="/img/item/${t.gfxId}.png" onerror="this.src='https://cdn.jsdelivr.net/gh/cckiss/web/img/shop/noimg.gif'" class="thumb" alt="">`);var s=[];let i=$(".price > .price-now");if("SELL"===TRADE_TYPE){if(t.sellList){for(var a,l=0,n=0;n<t.sellList.length;n++)l+=t.sellList[n].itemObjList.length;let r=commaAdd(l);$(".section-history .header").html(`판매 가격 현황 <em class="count">${r}</em>건`),i.find("h3").html("현재 판매가격"),i.find(".price-store").find("em").html(r),i.find(".price-qty").find("dfn").html("총 판매수량 :"),i.find(".price-qty").find("em").html(commaAdd(t.sellTotalCount)),t&&t.sellTotalPriceArray&&t.sellTotalPriceArray.length?(i.find(".price-min").find("em").html(t.sellTotalPriceArray[0]),i.find(".price-max").find("em").html(2===t.sellTotalPriceArray.length?t.sellTotalPriceArray[1]:t.sellTotalPriceArray[0])):(i.find(".price-min").find("em").html(0),i.find(".price-max").find("em").html(0));for(var n=0;n<t.sellList.length;n++)for(var c=0;c<t.sellList[n].itemObjList.length;c++)a=t.sellList[n].itemObjList[c],s.push([{bless:t.sellList[n].bless},a])}}else if(t.buyList){for(var a,d=0,n=0;n<t.buyList.length;n++)d+=t.buyList[n].itemObjList.length;let o=commaAdd(d);$(".section-history .header").html(`구매 가격 현황 <em class="count">${o}</em>건`),i.find("h3").html("현재 구매가격"),i.find(".price-store").find("em").html(o),i.find(".price-qty").find("dfn").html("총 구매수량 :"),i.find(".price-qty").find("em").html(commaAdd(t.buyTotalCount)),t&&t.buyTotalPriceArray&&t.buyTotalPriceArray.length?(i.find(".price-min").find("em").html(t.buyTotalPriceArray[0]),i.find(".price-max").find("em").html(2===t.buyTotalPriceArray.length?t.buyTotalPriceArray[1]:t.buyTotalPriceArray[0])):(i.find(".price-min").find("em").html(0),i.find(".price-max").find("em").html(0));for(var n=0;n<t.buyList.length;n++)for(var c=0;c<t.buyList[n].itemObjList.length;c++)a=t.buyList[n].itemObjList[c],s.push([{bless:t.buyList[n].bless},a])}s.sort(function(t,e){return t[1].price-e[1].price}),e(s)}},t=>{})},pageSize:10,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(t,e){var s="";t.length?$.each(t,function(t,e){let l=e[1].potential_grade,n;s+=`<div class="tr"><div class="td-row"><span class="td-enchant">${l||(e[1].enchant>0?`+${e[1].enchant}`:"-")}</span><span class="td-qty">${e[1].count}개</span><span class="td-price">${a(e[1].price)}</span></div><div class="td-row"><span class="td-status">${1==e[0].bless?`일반`:2==e[0].bless?`저주`:`축복`}</span><span class="td-attribute">${e[1].potential_desc||i(e[1].attr)}</span><span class="td-store">${isIngame?`<a href="javascript:L1.FindMerchant('${e[1].charName}');">${e[1].charName} (${e[1].loc})</a>`:`${e[1].charName} (${e[1].loc})`}</span></div></div>`}):s+=`<div class="nodata"><p>게임 내 개설 중인 상점이 없습니다.</p></div>`,$(".tbody").html(s),$(".data-loader").css("display","none")}})};let s=["없음","화령 1단","화령 2단","화령 3단","화령 4단","화령 5단","수령 1단","수령 2단","수령 3단","수령 4단","수령 5단","풍령 1단","풍령 2단","풍령 3단","풍령 4단","풍령 5단","지령 1단","지령 2단","지령 3단","지령 4단","지령 5단"];var i=function(t){return s[t]},a=function(t){if(t<=0)return"0";var e="";if(t>1e8){var s=parseInt(t/1e8);t-=1e8*s,e+=commaAdd(s)+"억"}if(t>1e4){var s=parseInt(t/1e4);t-=1e4*s,e+=" "+commaAdd(s)+"만"}return t>0&&(e+=" "+commaAdd(t)),e},l=$(".select"),n=$(".ui-dropdown");if(l.click(function(){var t=$(this).closest(".ui-dropdown");t.hasClass("is-active")?n.removeClass("is-active"):(n.removeClass("is-active"),t.addClass("is-active"))}),$("body").mouseup(function(t){!l.has(t.target).length&&!n.has(t.target).length&&n.hasClass("is-active")&&n.removeClass("is-active"),eventStop(t)}),$(".option > li").click(function(){var s=$(this).closest(".ui-dropdown");if(!$(this).hasClass("selected")){var i=$(this).html();if(i!==s.find("span").html()){var a=$(this).attr("data-value");s.find("span").html(i),$(this).closest(".option").children("li").removeClass("selected"),$(this).addClass("selected"),s.hasClass("dropdown-enchant")?t.enchant=a:s.hasClass("dropdown-status")?t.bless=a:s.hasClass("dropdown-attribute")&&(t.attr=a),$(".pagination-container").destory,e(t)}}s.removeClass("is-active")}),enchant>0){$(".dropdown-enchant").find("span").html("+"+enchant);var r=$(".dropdown-enchant").find(".option").children("li");r.removeClass("selected"),r.eq(enchant+1).addClass("selected")}if("ALL"!==bless){$(".dropdown-status").find("span").html("NORMAL"===bless?"일반":"BLESS"===bless?"축복":"저주");var c=$(".dropdown-status").find(".option").children("li");c.removeClass("selected"),c.eq("NORMAL"===bless?1:"BLESS"===bless?2:3).addClass("selected")}t.itemId=searchItemId,t.enchant=enchant,t.bless=bless,t.attr=searchAttr,t.tradeType=TRADE_TYPE,e(t)});
