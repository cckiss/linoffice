/*!
 * project : rank
 * author : LINOFFICE
 * 랭킹
 */ let rank_singleton=null,rank_singletonEnforcer="singletonEnforcer";class Rank{constructor(e){if(e!==rank_singletonEnforcer)throw"Cannot--construct singleton";this.init()}static get instance(){return rank_singleton||(rank_singleton=new Rank(rank_singletonEnforcer)),rank_singleton}init(){let e=this;e.parmaeter={charType:"all"},e.GAME_CLASS_NAME=["군주","기사","요정","마법사","다크엘프","용기사","환술사","전사","검사","창기사","성기사"],e.wrap=$(".table-ranking-area"),e.wrap_list=$(".table-list"),e.container=$(".pagination"),e.loader=$(".data-loader"),e.setInstance(),e.addEvents()}setInstance(){let e=this;e.loader.css("display","block"),e.container.pagination({dataSource:function(n){getDatasWithOption([{type:"POST",url:"/define/rank",dataType:"json",contentType:"application/json",Accept:"application/json",data:e.parmaeter}],e=>{n(e)},e=>{throw Error("render from rank.js Error")})},pageSize:20,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(n,t){let a="";$(".nodata").remove(),n.length?(a=n.map((n,t)=>{let a=n.curRank-n.oldRank,s=e.GAME_CLASS_NAME[n.classId],l=e.getGrade("all"===e.parmaeter.charType?n.curRank:n.subCurRank);return`<tr><td class="rank"><span class="num">${n.curRank}</span><span class="ui-rank ${a>0?"up":a<0?"down":""}">${0==a?"-":a}</span></td><td>${n.name}</td><td>${s}</td><td class="grade"><span class="star ${l}"></span></td></tr>`}).join(""),e.wrap_list.css("display","block")):(e.wrap_list.css("display","none"),$(".section-ranking-list").append(`<div class="nodata"><p>랭킹 정보가 존재하지 않습니다.</p></div>`)),e.wrap.html(a),e.loader.css("display","none")}})}getGrade(e){return 1==e?"top1":2==e?"top2":3==e?"top3":e>=4&&e<=10?"grade4":e>=11&&e<=20?"grade3":e>=21&&e<=60?"grade2":e>=61&&e<=80?"grade1":"grade0"}addEvents(){let e=this,n=$(window).width(),t=$(".ui-select-tab.select-tab-class"),a=$(".select-tab.option > li > a");$(window).resize(function(){let e=window.outerWidth;n=e,e<=960?t.find(".select").hasClass("open")&&(t.find(".select").removeClass("open"),t.find(".select-tab.option").css("display","none")):t.find(".select").hasClass("open")||(t.find(".select").addClass("open"),t.find(".select-tab.option").css("display","block"))}),a.on("click",function(s){let i=$(this).attr("data-type");if(e.parmaeter.charType===i){n<=960&&t.find(".select").hasClass("open")&&l(),eventStop(s);return}e.parmaeter.charType=i,a.removeClass("selected"),$(this).addClass("selected"),$("#rankingtop").html("all"===i?rank_total_range:rank_class_range),t.find(".select").html($(this).html()),e.container.destory,e.setInstance(),n<=960&&t.find(".select").hasClass("open")&&l(),eventStop(s)}),t.find(".select").on("click",function(){$(this).hasClass("open")?l():s()});let s=function(){t.find(".select").addClass("open"),t.find(".select-tab.option").css("display","block")},l=function(){t.find(".select").removeClass("open"),t.find(".select-tab.option").css("display","none")};$("body").mouseup(function(e){!(n<=960)||t.has(e.target).length||a.has(e.target).length||l(),eventStop(e)}),$(".section-ranking-mycharacter .detail-info").slick({dots:!0,arrows:!1,infinite:!0,slidesToShow:1,slidesToScroll:1}),n<=960?l():s()}}Rank.instance;
