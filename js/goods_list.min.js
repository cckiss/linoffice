/*!
 * project : goods_list
 * author : LINOFFICE
 * N샵 리스트
 */ let goods_list,goods_date_list=[],current_page_number=1,calc_timer;function get_goods(a){if(!goods_list)return null;for(var t=0;t<goods_list.length;t++){let s=goods_list[t][0];if(a===s.id)return s}return null}$(function(){query||(query="ALL");let a=""!==query.trim()&&"ALL"!==query.trim()?query:"1억 아데나 수표";$("#searchForm #SearchInput").val(a);let t=moment(),s=function(a){if(!a||!a.start_date&&!a.finish_date)return"";if(a.start_date){let s=moment(new Date(a.start_date)),e=t.isSameOrAfter(s);if(!e)return goods_date_list.push(a),`<span class="msg_area"><span class="msg">${s.format("판매 시작 - DD일 HH : mm ~")}</span></span>`}if(a.finish_date){let i=moment(new Date(a.finish_date)),n=t.isBefore(i);if(!n)return`<span class="msg_area"><span class="msg">판매 기간 종료</span></span>`;let r=i.diff(t,"days"),o=i.diff(t,"hours")%24,d=i.diff(t,"minutes")%60;return goods_date_list.push(a),`<span class="msg_area"><span class="msg">기간 한정 - ${r}일 ${o<10?"0":""}${o} : ${d<10?"0":""}${d}</span></span>`}return""},e=function(){if(!goods_date_list){clearInterval(calc_timer);return}let a=moment(),t=[];if($.each(goods_date_list,function(s,e){let i=$("[data-id="+e.id+"]").find(".msg_area");if(e.start_date){let n=moment(new Date(e.start_date));if(!a.isSameOrAfter(n))return!0;if(!e.finish_date)return t.push(e),i.remove(),!0}if(!e.finish_date)return!0;let r=moment(new Date(e.finish_date));if(!a.isBefore(r))return t.push(e),i.find(".msg").text("판매 기간 종료"),!0;let o=r.diff(a,"days"),d=r.diff(a,"hours")%24,l=r.diff(a,"minutes")%60;i.find(".msg").text(`기간 한정 - ${o}일 ${d<10?"0":""}${d} : ${l<10?"0":""}${l}`)}),t.length)for(var s=0;s<t.length;s++)for(var e=0;e<goods_date_list.length;e++)t[s].id==goods_date_list[e].id&&goods_date_list.splice(e,1)},i=function(){goods_date_list&&(calc_timer=setInterval(e,6e4))},n=$(".pagination-container");n.pagination({dataSource:function(a){getDatasWithOption([{type:"POST",url:"/define/goods",dataType:"json",contentType:"application/json",Accept:"application/json",data:{query:query}}],t=>{a(t)},a=>{})},pageSize:18,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(a,t){let e="";a.length?(goods_list=a,$.each(a,function(a,t){let i=t[0];e+=`<div class="sub_card"><div class="box" id="displayGoodsData" data-id="${i.id}"><a href="javascript:urlform('${i.id}', 'post', '/goods/view');" class="lnk_detail">`+s(i)+i.flagTag_1+`<div class="img_area"><img src="${i.icon_image}" alt="" class="item_img"></div>`+'<div class="item_info"><div class="v_align">'+`<div class="tit_area"><em class="tit">${i.title}</em></div>`+`<div class="coin_area">${"NCOIN"===i.price_type?'<span class="ncoin">':'<span class="npoint">'}${commaAdd(i.price)}</span></div>`+'</div></div></a><div class="btn_area">'+(t.length>1?`<a href="javascript:urlform('${i.id}', 'post', '/goods/view');" class="btn direct fn_orderform">구매</a>`:`<a href="javascript:index_page_buy_confirm(${i.id})" class="btn direct fn_orderform">바로구매</a>`)+"</div></div></div>"}),i()):e+='<div class="search_not_found"><em>검색결과가 없습니다.</em><p>검색어의 철자가 정확한지 확인해주세요.<br> 검색어가 두 단어 이상일 경우, 띄어쓰기를 확인해주세요.</p></div>',$(".data-loader").css("display","none"),$(".sub_wrap").html(e)}}),n.addHook("beforePageOnClick",function(a,t){current_page_number=t}),n.addHook("afterInit",function(a){let t=JSON.parse(getSession("PAGINATION_INFINITE_LIST"));if(t&&"goods"==t.page_type){let s=current_page_number=t.page_number,e=t.scroll_Y;s>1&&n.pagination("go",s),e>0&&window.scrollTo(0,e)}removeSession("PAGINATION_INFINITE_LIST")})});
