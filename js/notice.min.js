/*!
 * project : notice
 * author : LINOFFICE
 * 소식
 */ $(function(){includeHTML(document.querySelector("#svg-container"),"https://cdn.jsdelivr.net/gh/cckiss/web/svg.html",cacheVersion);var s=$(".ui-dropdown"),a=$(".ui-dropdown-custom_items"),e=$(".co-btn-reset"),t=$(".btn-list"),i=$(".btn-cards"),o=$(".ncCommunityBoardList"),n=$(".co-btn-top_list"),c=$(".btn-type-selected");s.on("click",function(s){$(this).toggleClass("is-active")}),a.on("click",function(s){$(".ui-dropdown-community.is-active .select").find("span").html($(this).attr("data-textvalue")),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),e.on("click",function(s){$("#ncCommunitySearch").val("")});var l=function(s){$(".co-btn").removeClass("is-disabled"),"card"==s?(t.addClass("is-disabled"),o.hasClass("board-list-default")&&o.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),c.removeClass("list"),c.addClass("card"),c.html("<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>")):(i.addClass("is-disabled"),o.hasClass("board-list-card")&&o.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),c.removeClass("card"),c.addClass("list"),c.html("<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>")),c.removeClass("is-show")};t.on("click",function(s){o.hasClass("board-list-card")&&(l("list"),setLocal("board_notice_viewMode","list"))}),i.on("click",function(s){o.hasClass("board-list-default")&&(l("card"),setLocal("board_notice_viewMode","card"))}),"card"==getLocal("board_notice_viewMode")&&l("card"),n.on("click",function(s){$(window).scrollTop(0),s.preventDefault()}),c.on("click",function(s){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(s){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(s){$("#wrapSearch").removeClass("is-show")}),$("body").mouseup(function(s){!$(".option").has(s.target).length&&!$(".ui-dropdown.is-active").has(s.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(s.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(s)});var r=$(".nowCheckvalue");r&&r.length&&$.each(r,function(s,a){if(!a.value){var e=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(e)}})});let more_btn_lock=!1;function noticeMore(){if(more_btn_lock)return;more_btn_lock=!0;let s=$(".nc-community-loader");s.css("display","");var a=$("#noticeType").val(),e=$("#totSize").val(),t=$("#cursize").val();getDatasWithOption([{type:"POST",url:"/define/notice/more",dataType:"json",contentType:"application/json",Accept:"application/json",data:{size:t,noticeType:a}}],a=>{var i="";$.each(a,function(s,a){i+=createNoticeHtml(a)}),$(i).appendTo(".ncCommunityBoardList"),a.length&&($("#cursize").val(Number(t)+Number(a.length)),$("#totSize").val(Number(e)-Number(a.length)),$("#totSize").val()?$(".wrap-community-more").html('<button class="nc-comment-more" onClick="javascritp:noticeMore();"><span class="txt">더보기</span></button>'):$(".wrap-community-more").html("")),s.css("display","none"),more_btn_lock=!1},a=>{throw s.css("display","none"),more_btn_lock=!1,Error("noticeMore from notice.js Error")})}function createNoticeHtml(s){var a=$(".ncCommunityBoardList"),e="",t="display:none;";a.hasClass("board-list-card")&&(e="display:none;",t="");var i="",o="";switch(s.type){case 1:i="업데이트",o="/update/view";break;case 2:i="이벤트",o="/event/view";break;default:i="공지",o="/notice/view"}let n=`<span class="category">${i}&nbsp</span>`,c='<span class="writer"><img src="https://cdn.jsdelivr.net/gh/cckiss/web/img/lineage_writer.png" alt=""></span>&nbsp',l=`<span class="date">${moment(new Date(s.date)).format("YY.MM.DD.")}</span>&nbsp`,r=moment().format("YYYYMMDD"),d=moment(new Date(s.date)).format("YYYYMMDD"),p=r-d;return`<li class="board-items" onClick='urlTypeform("${s.type}", "${s.rownum}", "post", "${o}");'><div class="title board-type-list" style="${e}">`+n+`<a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${o}");'>${s.title}</a>`+`${s.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':""}`+`${0===p?'&nbsp<i class="fe-icon-new" data-diff=""></i>':""}`+"</div>"+`<div class="info board-type-list" style="${e}">`+c+l+`<span class="hit"><em class="txt">조회</em>${s.readcount}</span>`+"</div>"+`<div class="board-type-card" style="${t}">`+`${s.mainImg?`<div class="board-items-thumb"><a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${o}");'><img src="${s.mainImg}" alt=""></a></div>`:""}`+'<div class="board-items-contents">'+`<div class="title">${n}<a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${o}");'>${s.title}${0===p?'&nbsp<i class="fe-icon-new"></i></a>':"</a>"}</div>`+`<div class="desc desc-overflow"><a href='javascript:urlTypeform("${s.type}", "${s.rownum}", "post", "${o}");'>${s.content}</a></div>`+c+"</div>"+`<div class="board-items-footer"><div class="info"><span class="writer">${s.name}</span>${l}<span class="hit-count"><span class="txt">조회 </span><em>${s.readcount}</em></span></div></div>`+"</div></li>"}function noticeWriteFormCheck(){var s=document.boardWriteForm;return account&&account.firstChar?(s.name.value=account.firstChar.name,s.noti_type.value)?s.title.value?s.content.value?!!maxByteCheck(s.content.value,1)&&(Editor.instance.setSubmit(),!0):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("유형을 선택해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("로그인 후 등록할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function delectNoticeConfirm(s,a){popupShow(`정말로 삭제하시겠습니까?`,`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:deleteNoticeConfirmAction(${s}, ${a});" class="close">예</a></span>`)}function deleteNoticeConfirmAction(s,a){let e=$(".board-view .view-body").find("img");urlTypeform(a,s,"post","/notice/delete"+getDeleteImgSrc(e))}function getDeleteImgSrc(s){let a="";if(s&&s.length){a+="?deleteImgList=";for(var e=0;e<s.length;e++)e>0&&(a+=","),a+=s.eq(e).attr("src")}return a}
