/*!
 * project : notice
 * author : LINOFFICE
 * 소식
 */ $(function(){includeHTML(document.querySelector("#svg-container"),"https://cdn.jsdelivr.net/gh/cckiss/web/svg.html");var e=$(".ui-dropdown"),s=$(".ui-dropdown-custom_items"),a=$(".co-btn-reset"),t=$(".btn-list"),o=$(".btn-cards"),i=$(".ncCommunityBoardList"),n=$(".co-btn-top_list"),c=$(".btn-type-selected");e.on("click",function(e){$(this).toggleClass("is-active")}),s.on("click",function(e){$(".ui-dropdown-community.is-active .select").find("span").html($(this).attr("data-textvalue")),$(".ui-dropdown-community.is-active .select").find("#data_val").val($(this).attr("data-value"))}),a.on("click",function(e){$("#ncCommunitySearch").val("")});var l=function(e){$(".co-btn").removeClass("is-disabled"),"card"==e?(t.addClass("is-disabled"),i.hasClass("board-list-default")&&i.removeClass("board-list-default"),$(".ncCommunityBoardList").addClass("board-list-card"),$(".board-type-card").show(),$(".board-type-list").hide(),c.removeClass("list"),c.addClass("card"),c.html("<svg class='fe-svg fe-svg-card'><use xlink:href='#fe-svg-card'></use></svg>")):(o.addClass("is-disabled"),i.hasClass("board-list-card")&&i.removeClass("board-list-card"),$(".ncCommunityBoardList").addClass("board-list-default"),$(".board-type-list").show(),$(".board-type-card").hide(),c.removeClass("card"),c.addClass("list"),c.html("<svg class='fe-svg fe-svg-list'><use xlink:href='#fe-svg-list'></use></svg>")),c.removeClass("is-show")};t.on("click",function(e){i.hasClass("board-list-card")&&(l("list"),setLocal("board_notice_viewMode","list"))}),o.on("click",function(e){i.hasClass("board-list-default")&&(l("card"),setLocal("board_notice_viewMode","card"))}),"card"==getLocal("board_notice_viewMode")&&l("card"),n.on("click",function(e){$(window).scrollTop(0),e.preventDefault()}),c.on("click",function(e){$(this).toggleClass("is-show")}),$(".input-board-search").on("click",function(e){$("#wrapSearch").addClass("is-show")}),$(".co-btn-clear").on("click",function(e){$("#wrapSearch").removeClass("is-show")}),$("body").mouseup(function(e){!$(".option").has(e.target).length&&!$(".ui-dropdown.is-active").has(e.target).length&&$(".ui-dropdown").hasClass("is-active")&&$(".ui-dropdown").removeClass("is-active"),!$("#wrapSearch").has(e.target).length&&$("#wrapSearch").hasClass("is-show")&&($("#wrapSearch").removeClass("is-show"),$("#ncCommunitySearch").val("")),eventStop(e)});var r=$(".nowCheckvalue");r&&r.length&&$.each(r,function(e,s){if(!s.value){var a=getNowDayTimeToFormat($(this).closest(".board-items").find(".nowCheckdate").val());$(this).closest(".board-items").find(".date").html(a)}})});let more_btn_lock=!1;function noticeMore(){if(more_btn_lock)return;more_btn_lock=!0;let e=$(".nc-community-loader");e.css("display","");var s=$("#noticeType").val(),a=$("#totSize").val(),t=$("#cursize").val();getDatasWithOption([{type:"POST",url:"/define/notice/more",dataType:"json",contentType:"application/json",Accept:"application/json",data:{size:t,noticeType:s}}],s=>{var o="";$.each(s,function(e,s){o+=createNoticeHtml(s)}),$(o).appendTo(".ncCommunityBoardList"),s.length&&($("#cursize").val(Number(t)+Number(s.length)),$("#totSize").val(Number(a)-Number(s.length)),$("#totSize").val()?$(".wrap-community-more").html('<button class="nc-comment-more" onClick="javascritp:noticeMore();"><span class="txt">더보기</span></button>'):$(".wrap-community-more").html("")),e.css("display","none"),more_btn_lock=!1},s=>{throw e.css("display","none"),more_btn_lock=!1,Error("noticeMore from notice.js Error")})}function createNoticeHtml(e){var s=$(".ncCommunityBoardList"),a="",t="display:none;";s.hasClass("board-list-card")&&(a="display:none;",t="");var o="",i="";switch(e.type){case 1:o="업데이트",i="/update/view";break;case 2:o="이벤트",i="/event/view";break;default:o="공지",i="/notice/view"}let n=`<span class="category">${o}&nbsp</span>`,c='<span class="writer"><img src="https://cdn.jsdelivr.net/gh/cckiss/web/img/lineage_writer.png" alt=""></span>&nbsp',l=`<span class="date">${moment(new Date(e.date)).format("YY.MM.DD.")}</span>&nbsp`,r=moment().format("YYYYMMDD"),d=moment(new Date(e.date)).format("YYYYMMDD"),p=r-d;return`<li class="board-items" onClick='urlTypeform("${e.type}", "${e.rownum}", "post", "${i}");'><div class="title board-type-list" style="${a}">`+n+`<a href='javascript:urlTypeform("${e.type}", "${e.rownum}", "post", "${i}");'>${e.title}</a>`+`${e.mainImg?'<svg class="fe-svg fe-svg-picture"><use xlink:href="#fe-svg-picture"></use></svg>':""}`+`${0===p?'&nbsp<i class="fe-icon-new" data-diff=""></i>':""}`+"</div>"+`<div class="info board-type-list" style="${a}">`+c+l+`<span class="hit"><em class="txt">조회</em>${e.readcount}</span>`+"</div>"+`<div class="board-type-card" style="${t}">`+`${e.mainImg?`<div class="board-items-thumb"><a href='javascript:urlTypeform("${e.type}", "${e.rownum}", "post", "${i}");'><img src="${e.mainImg}" alt=""></a></div>`:""}`+'<div class="board-items-contents">'+`<div class="title">${n}<a href='javascript:urlTypeform("${e.type}", "${e.rownum}", "post", "${i}");'>${e.title}${0===p?'&nbsp<i class="fe-icon-new"></i></a>':"</a>"}</div>`+`<div class="desc desc-overflow"><a href='javascript:urlTypeform("${e.type}", "${e.rownum}", "post", "${i}");'>${e.content}</a></div>`+c+"</div>"+`<div class="board-items-footer"><div class="info"><span class="writer">${e.name}</span>${l}<span class="hit-count"><span class="txt">조회 </span><em>${e.readcount}</em></span></div></div>`+"</div></li>"}function noticeWriteFormCheck(){var e=document.boardWriteForm;return account&&account.firstChar?(e.name.value=account.firstChar.name,e.noti_type.value)?e.title.value?e.content.value?!!maxByteCheck(e.content.value,1):(popupShow("내용을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("제목을 입력해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("유형을 선택해주세요.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1):(popupShow("로그인 후 등록할 수 있습니다.",'<span class="type2"><a href="javascript:popupClose();" class="close">닫기</a></span>',null),!1)}function delectNoticeConfirm(e,s){popupShow(`정말로 삭제하시겠습니까?`,`<span class="type2"><a href="javascript:popupClose();" class="close">아니오</a></span>`,`<span class="type1"><a href="javascript:deleteNoticeConfirmAction(${e}, ${s});" class="close">예</a></span>`)}function deleteNoticeConfirmAction(e,s){let a=$(".board-view .view-body").find("img");urlTypeform(s,e,"post","/notice/delete"+getDeleteImgSrc(a))}function getDeleteImgSrc(e){let s="";if(e&&e.length){s+="?deleteImgList=";for(var a=0;a<e.length;a++)a>0&&(s+=","),s+=e.eq(a).attr("src")}return s}function boardCancel(e){let s=$("#tempList").val(),a=$("#oriContent").val(),t=$("#oriList").val();if(!s&&!t){history.back();return}getDatasWithOption([{type:"POST",url:"update"==e?"/define/editor/updatecancel":"/define/editor/insertcancel",dataType:"json",contentType:"application/json",Accept:"application/json",data:{tempList:s,oriContent:a,oriList:t},cache:!1}],e=>{history.back()},e=>{throw Error("boardCancel from notice.js Error")})}
