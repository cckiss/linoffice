/*!
 * project : shop_list
 * author : LINOFFICE
 * 시세
 */ "SELL"===TRADE_TYPE?($("#tab_sell").addClass("active"),$(".item-price > .price").addClass("price-sell")):"BUY"===TRADE_TYPE&&($("#tab_buy").addClass("active"),$(".item-price > .price").addClass("price-buy")),$(function(){navigator.userAgent.toLowerCase();let t=account&&account.ingame;var e={itemId:"-1",enchant:-1,bless:"ALL",attr:"ALL",tradeType:"SELL"},s=function(e){$(".pagination-container").pagination({dataSource:function(t){$.ajax({type:"POST",url:"/define/item-search/view-list",data:e,success:function(e){if(e){$(".search-util__result .count").html(e.length),$(".thumbnail").html('<img src="/img/item/'+e.gfxId+'.png" onerror="this.src=\'/img/shop/noimg.gif\'" class="thumb" alt="">');var s=[];let i=$(".price > .price-now");if("SELL"===TRADE_TYPE){if(e.sellList){for(var a,l=0,n=0;n<e.sellList.length;n++)l+=e.sellList[n].itemObjList.length;let r=commaAdd(l);$(".section-history .header").html('판매 가격 현황 <em class="count">'+r+"</em>건"),i.find("h3").html("현재 판매가격"),i.find(".price-store").find("em").html(r),i.find(".price-qty").find("dfn").html("총 판매수량 :"),i.find(".price-qty").find("em").html(commaAdd(e.sellTotalCount)),e&&e.sellTotalPriceArray&&e.sellTotalPriceArray.length?(i.find(".price-min").find("em").html(e.sellTotalPriceArray[0]),i.find(".price-max").find("em").html(2===e.sellTotalPriceArray.length?e.sellTotalPriceArray[1]:e.sellTotalPriceArray[0])):(i.find(".price-min").find("em").html(0),i.find(".price-max").find("em").html(0));for(var n=0;n<e.sellList.length;n++)for(var c=0;c<e.sellList[n].itemObjList.length;c++)a=e.sellList[n].itemObjList[c],s.push([{bless:e.sellList[n].bless},a])}}else if(e.buyList){for(var a,d=0,n=0;n<e.buyList.length;n++)d+=e.buyList[n].itemObjList.length;let o=commaAdd(d);$(".section-history .header").html('구매 가격 현황 <em class="count">'+o+"</em>건"),i.find("h3").html("현재 구매가격"),i.find(".price-store").find("em").html(o),i.find(".price-qty").find("dfn").html("총 구매수량 :"),i.find(".price-qty").find("em").html(commaAdd(e.buyTotalCount)),e&&e.buyTotalPriceArray&&e.buyTotalPriceArray.length?(i.find(".price-min").find("em").html(e.buyTotalPriceArray[0]),i.find(".price-max").find("em").html(2===e.buyTotalPriceArray.length?e.buyTotalPriceArray[1]:e.buyTotalPriceArray[0])):(i.find(".price-min").find("em").html(0),i.find(".price-max").find("em").html(0));for(var n=0;n<e.buyList.length;n++)for(var c=0;c<e.buyList[n].itemObjList.length;c++)a=e.buyList[n].itemObjList[c],s.push([{bless:e.buyList[n].bless},a])}s.sort(function(t,e){return t[1].price-e[1].price}),t(s)}}})},pageSize:10,showPrevious:!1,showNext:!1,showPageNumbers:!0,callback:function(e,s){var i="";e.length?$.each(e,function(e,s){let n=s[1].potential_grade,r=s[1].potential_desc;i+='<div class="tr"><div class="td-row"><span class="td-enchant">'+(n||(s[1].enchant>0?"+"+s[1].enchant:"-"))+'</span><span class="td-qty">'+s[1].count+'개</span><span class="td-price">'+l(s[1].price)+'</span></div><div class="td-row"><span class="td-status">'+(1==s[0].bless?"일반":2==s[0].bless?"저주":"축복")+'</span><span class="td-attribute">'+(r||a(s[1].attr))+'</span><span class="td-store">'+(t?"<a href=\"javascript:L1.FindMerchant('"+s[1].charName+"');\">"+s[1].charName+" ("+s[1].loc+")</a>":s[1].charName+" ("+s[1].loc+")")+"</span></div></div>"}):i+='<div class="nodata"><p>게임 내 개설 중인 상점이 없습니다.</p></div>',$(".tbody").html(i)}})};let i=["없음","화령 1단","화령 2단","화령 3단","화령 4단","화령 5단","수령 1단","수령 2단","수령 3단","수령 4단","수령 5단","풍령 1단","풍령 2단","풍령 3단","풍령 4단","풍령 5단","지령 1단","지령 2단","지령 3단","지령 4단","지령 5단"];var a=function(t){return i[t]},l=function(t){if(t<=0)return"0";var e="";if(t>1e8){var s=parseInt(t/1e8);t-=1e8*s,e+=commaAdd(s)+"억"}if(t>1e4){var s=parseInt(t/1e4);t-=1e4*s,e+=" "+commaAdd(s)+"만"}return t>0&&(e+=" "+commaAdd(t)),e},n=$(".select"),r=$(".ui-dropdown");n.click(function(){var t=$(this).closest(".ui-dropdown");t.hasClass("is-active")?r.removeClass("is-active"):(r.removeClass("is-active"),t.addClass("is-active"))}),$("body").mouseup(function(t){!n.has(t.target).length&&!r.has(t.target).length&&r.hasClass("is-active")&&r.removeClass("is-active"),eventStop(t)}),$(".option > li").click(function(){var t=$(this).closest(".ui-dropdown");if(!$(this).hasClass("selected")){var i=$(this).html();if(i!==t.find("span").html()){var a=$(this).attr("data-value");t.find("span").html(i),$(this).closest(".option").children("li").removeClass("selected"),$(this).addClass("selected"),t.hasClass("dropdown-enchant")?e.enchant=a:t.hasClass("dropdown-status")?e.bless=a:t.hasClass("dropdown-attribute")&&(e.attr=a),$(".pagination-container").destory,s(e)}}t.removeClass("is-active")}),$(document).ready(function(){if(enchant>0){$(".dropdown-enchant").find("span").html("+"+enchant);var t=$(".dropdown-enchant").find(".option").children("li");t.removeClass("selected"),t.eq(enchant+1).addClass("selected")}if("ALL"!==bless){$(".dropdown-status").find("span").html("NORMAL"===bless?"일반":"BLESS"===bless?"축복":"저주");var i=$(".dropdown-status").find(".option").children("li");i.removeClass("selected"),i.eq("NORMAL"===bless?1:"BLESS"===bless?2:3).addClass("selected")}e.itemId=searchItemId,e.enchant=enchant,e.bless=bless,e.attr=searchAttr,e.tradeType=TRADE_TYPE,s(e)})});